"use strict";(self["webpackChunkspinner"]=self["webpackChunkspinner"]||[]).push([[832],{3502:(e,n,t)=>{t.r(n),t.d(n,{default:()=>A});var i=t(3673),a=t(2323);function o(e,n,t,o,s,c){const r=(0,i.up)("l-tile-layer"),l=(0,i.up)("custom-marker"),d=(0,i.up)("VecjiObsegMarker"),p=(0,i.up)("l-map"),u=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(p,{center:s.center,"onUpdate:center":n[0]||(n[0]=e=>s.center=e),zoom:s.zoom,"onUpdate:zoom":n[1]||(n[1]=e=>s.zoom=e),bounds:s.bounds,"onUpdate:bounds":n[2]||(n[2]=e=>s.bounds=e),style:{width:"100vw","min-height":"inherit"},zoomAnimation:!0,ref:"map",class:(0,a.C_)(o.$q.dark.isActive?"darkMode-map":"")},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{url:o.$q.dark.isActive?"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png?api_key=f215e444-ed38-469a-a2e5-5dec032793d5":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},null,8,["url"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.intervencijeAll,((e,n)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:n},["normal"==e.type?((0,i.wg)(),(0,i.j4)(l,{key:0,intervencija:e,marker:{lat:e.wgsLat,lng:e.wgsLon},offsetX:-35,offsetY:-90,onClick:n=>c.showDetails(e)},null,8,["intervencija","marker","onClick"])):((0,i.wg)(),(0,i.j4)(d,{key:1,intervencija:e,onClick:n=>c.showDetails(e)},null,8,["intervencija","onClick"]))],64)))),128))])),_:1},8,["center","zoom","bounds","class"])])),_:1})}var s=t(8892),c=t(6392);function r(e,n,t,a,o,s){const c=(0,i.up)("l-geo-json");return(0,i.wg)(),(0,i.j4)(c,{geojson:o.geojson},null,8,["geojson"])}var l=t(52),d=t.n(l);const p={props:{intervencija:{type:Object,required:!0}},components:{LGeoJson:s.jK},data(){return{geojson:null}},async created(){const e=await d().get("https://raw.githubusercontent.com/jky-btw/obcineGeoJson/main/data/"+this.intervencija.obcinaMID+".geojson");this.geojson=e.data}};var u=t(4260);const m=(0,u.Z)(p,[["render",r]]),g=m;var v=t(8880);const h={class:"row justify-between items-center no-wrap fit"},j={class:"column content-center"},w={class:"intervencija-title q-pb-sm"},f={class:"intervencija-date q-pb-sm flex items-center"},k={class:"intervencija-location flex items-center"};function b(e,n,t,o,s,c){const r=(0,i.up)("q-icon"),l=(0,i.up)("SpinnerIntIcon"),d=(0,i.up)("q-card-section"),p=(0,i.up)("q-card"),u=(0,i.up)("q-dialog"),m=(0,i.Q2)("touch-swipe");return(0,i.wy)(((0,i.wg)(),(0,i.j4)(u,{seamless:"",position:"bottom",ref:"dialogRef",onHide:o.onDialogHide},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{class:"q-dialog-plugin",onClick:n[0]||(n[0]=e=>o.expanded=!o.expanded)},{default:(0,i.w5)((()=>[(0,i._)("div",h,[(0,i._)("div",j,[(0,i._)("div",w,[(0,i._)("b",null,(0,a.zw)(t.intervencija.dogodekNaziv||t.intervencija.intervencijaVrstaNaziv||"Večji obseg"),1)]),(0,i._)("div",f,[(0,i.Wm)(r,{class:"q-pr-sm",name:"alarm",size:"sm"}),(0,i.Uk)(" "+(0,a.zw)(t.intervencija.nastanekDatumFormatted+" "+(t.intervencija.nastanekCasFormatted||"")),1)]),(0,i._)("div",k,[(0,i.Wm)(r,{class:"q-pr-sm",name:"location_on",size:"sm"}),(0,i.Uk)(" "+(0,a.zw)(t.intervencija.obcinaNaziv),1)])]),(0,i.Wm)(l,{intervencija:t.intervencija},null,8,["intervencija"])]),(0,i.Wm)(v.uT,{"enter-active-class":"animated backInDown","leave-active-class":"animated backOutUp"},{default:(0,i.w5)((()=>[o.expanded&&t.intervencija.besedilo?((0,i.wg)(),(0,i.j4)(d,{key:0,class:(0,a.C_)(o.desktop?"no-animation":"")},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.intervencija.besedilo),1)])),_:1},8,["class"])):(0,i.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["onHide"])),[[m,c.handleSwipe,void 0,{mouse:!0,down:!0}]])}t(71);var y=t(1959),z=t(1701),_=t(8825),C=t(1440);const D={name:"SmallPreview",components:{SpinnerIntIcon:C.Z},props:{intervencija:{type:Object,required:!0}},emits:[...z.Z.emits],setup(){const e=(0,_.Z)();let n=e.platform.is.desktop,t=(0,y.iH)(n);const{dialogRef:i,onDialogHide:a,onDialogOK:o,onDialogCancel:s}=(0,z.Z)();return{dialogRef:i,onDialogHide:a,onOKClick(){o()},onCancelClick:s,expanded:t,desktop:n}},methods:{handleSwipe(){this.dialogRef.hide()}}};var q=t(5926),Z=t(151),x=t(4554),S=t(5589),L=t(8020),U=t(7518),H=t.n(U);const I=(0,u.Z)(D,[["render",b],["__scopeId","data-v-5a8f2542"]]),M=I;H()(D,"components",{QDialog:q.Z,QCard:Z.Z,QIcon:x.Z,QCardSection:S.Z}),H()(D,"directives",{TouchSwipe:L.Z});var O=t(3617);const P={name:"SpinnerMapPage",components:{LMap:s.iA,LTileLayer:s.Hw,CustomMarker:c.Z,VecjiObsegMarker:g},setup(){let e=null;const n=(0,_.Z)();function t(e){return n.dialog({component:M,componentProps:{intervencija:e}}).onOk((()=>{})).onCancel((()=>{})).onDismiss((()=>{this.dialog=null}))}return{createPopUp:t,dialog:e,$q:n}},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:12,iconSize:32,center:[46.056946,14.505751],bounds:null}},computed:{...(0,O.Se)("intervencije",["intervencijeAll","isFetched"]),...(0,O.Se)("location",["location"])},watch:{location:function(e){this.center=e}},mounted(){this.fetchLocation(),this.isFetched||this.fetchData()},methods:{...(0,O.nv)("intervencije",["fetchData"]),...(0,O.nv)("settings",["darkMode"]),...(0,O.nv)("location",["fetchLocation"]),async showDetails(e){if(this.centerTo(e),this.dialog){this.dialog.hide();while(this.dialog)await new Promise((e=>setTimeout(e,200)));this.dialog=this.createPopUp(e)}else this.dialog=this.createPopUp(e)},async centerTo(e){if("normal"==e.type)this.center=[e.wgsLat,e.wgsLon];else{const n=await d().get("https://raw.githubusercontent.com/jky-btw/obcineGeoJson/main/data/"+e.obcinaMID+".geojson");this.bounds=[[n.data.features[0].bbox[1],n.data.features[0].bbox[0]],[n.data.features[0].bbox[3],n.data.features[0].bbox[2]]]}}},activated(){if(this.$route.params.intervencija){const e=JSON.parse(this.$route.params.intervencija);this.centerTo(e),this.zoom=15}},deactivated(){this.dialog&&this.dialog.hide()}};var T=t(4379);const W=(0,u.Z)(P,[["render",o]]),A=W;H()(P,"components",{QPage:T.Z})}}]);